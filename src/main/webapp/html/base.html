<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<meta name="author" content="Julie Chen">
	<meta name="description" content="Hack Productivity 3">

	<title>License Sharing</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
	<link rel="stylesheet" href="../css/flipclock.css">

	</head>
	<body>

	<div ng-app="licenseSharingApp" id="wrap">

		<div class="card">
			<h3 class="card-header">Instructions</h3>
			<div class="card-block">
				<p class="card-text">1) By clicking "Start Clock" button, it starts the Timer and assign the license.</p>
				<p class="card-text">2) Type in username = "tester@pwchen.onmicrosoft.com", password = "TesterHack3".</p>
				<h4 class="card-title">Once clock stops, you can no longer access the product.</h4>
				<h4 class="card-title">Save your work before the clock stops!</h4>
				<a href="#!licenseshare" class="btn btn-primary" ng-disabled="checked" id="startclock">Start Clock</a>
			</div>
		</div>

		<div ng-view></div>

	</div>

	<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.5/angular.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.5/angular-route.min.js"></script>

	<!-- script src="https://secure.aadcdn.microsoftonline-p.com/lib/0.1.3/js/msal.min.js"></script -->
	<!-- script type="text/javascript" src="../scripts/msalconfig.js"></script -->

	<!-- IE support: add promises polyfill before msal.js  -->
	<!-- The 'bluebird' and 'fetch' references below are required if you need to run this application on Internet Explorer -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.4/bluebird.min.js" class="pre"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/fetch/2.0.3/fetch.min.js"></script>

	<!-- script type="text/javascript" src="../scripts/app.js"></script -->

	<script src="../scripts/flipclock.js"></script>

	<script>
var app = angular.module("licenseSharingApp", ["ngRoute"]);
app.config(function($routeProvider) {
    $routeProvider
    .when("/licenseshare", {
        templateUrl : "LicenseShare.html",
        controller : "MainController"
    })
});

app.controller("MainController", ['$scope', '$rootScope', '$http', function(sc, rs, hp) {

  var req = {
     method: "POST",
     url: "https://graph.microsoft.com/v1.0/users",
     headers: {
       'Content-type' : "application/json",
       'Authorization': "Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFCSGg0a21TX2FLVDVYcmp6eFJBdEh6M01YTTdSVS1yLUFvOGN5bmJjRlRjVWJsd3N6bmJRLWd1eE1BMDlocWxBbTA4dk9RLWFFdm1teEROT3Zfel9FVlNNeTVnell1YlljYW04LTRHZU5fZENBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoieDQ3OHh5T3Bsc00xSDdOWGs3U3gxN3gxdXBjIiwia2lkIjoieDQ3OHh5T3Bsc00xSDdOWGs3U3gxN3gxdXBjIn0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hMDkzNzU0Ni1mNmQ0LTQwZTAtYWEzMi1mN2MzN2M4MDFhNGYvIiwiaWF0IjoxNTEzNDY2MjM1LCJuYmYiOjE1MTM0NjYyMzUsImV4cCI6MTUxMzQ3MDEzNSwiYWlvIjoiWTJOZ1lOZys5OEFPNXZXWFBtZHNGamE3OFRYcU9nQT0iLCJhcHBfZGlzcGxheW5hbWUiOiJMaWNlbnNlIFNoYXJlIiwiYXBwaWQiOiI1ZGU5OTU2My00ZWVjLTRjYzYtOTU5Yy04YWE0YTk3ZDBkNjkiLCJhcHBpZGFjciI6IjEiLCJpZHAiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hMDkzNzU0Ni1mNmQ0LTQwZTAtYWEzMi1mN2MzN2M4MDFhNGYvIiwidGlkIjoiYTA5Mzc1NDYtZjZkNC00MGUwLWFhMzItZjdjMzdjODAxYTRmIiwidXRpIjoiNzdlU0oyTGoza09qdEZ4VUhHZ1VBQSIsInZlciI6IjEuMCJ9.fivYehOEfdcsWm_0w18gwK7AR4NzwVS3d3DBFb4T4liO-GqXfUtjmpkcZRE5OUp7tQTUL4aKCNFQ_C9o7dwNJ-5oErto00oczPazZiMCy71Tv96VMMFpqoJ0lrf_GbkVEvsja3SXzbATCwJX4rZ3Dftarb225o-NV0vVPqO6CwToZ65NsTAKriYOR2j45H1Mvqahtu0qj71otF-WqXD37xdRx9_MsEvylw4kQjxzhPHasJ_vUd_Dtg7YZfhIxTP6WXbz89je5x-FhnCu5mQhK1BGyAmKbdNa-eRpuWFtUiWn3Ub6loDdQix1Sy-wShpHZ7bh0jngOkvb8YZyVhM_BA"
     },
     data: {
  		"accountEnabled": true,
  		"city": "Mountain View",
  		"country": "United States",
  		"department": "Sales & Marketing",
  		"displayName": "Hack Productivity 3",
  		"givenName": "Hack",
  		"jobTitle": "Marketing Director",
  		"mailNickname": "Hack3",
  		"passwordPolicies": "DisablePasswordExpiration",
  		"passwordProfile": {
    		"password": "Test1234",
    		"forceChangePasswordNextSignIn": false
  		},
  		"officeLocation": "131/1105",
  		"postalCode": "98052",
  		"preferredLanguage": "en-US",
  		"state": "CA",
  		"streetAddress": "9256 Towne Center Dr., Suite 400",
  		"surname": "Productivity",
  		"mobilePhone": "+1 206 555 0110",
  		"usageLocation": "US",
  		"userPrincipalName": "Hack3@pwchen.onmicrosoft.com"
	  }
  };

  var req2 = {
     method: "GET",
     url: "https://graph.microsoft.com/v1.0/bce4a0bd-2c22-402b-9f67-cfdd65ba1fee/",
     headers: {
       'Authorization': "Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFCSGg0a21TX2FLVDVYcmp6eFJBdEh6OElFQ1hIWm10UmppYVZLRG04T0pzOXowMFpnc3h4cmktbXlkcUNSS1hESkxJY1RNalhrZ0NCQW50TDdjNG4zaFZhNGluaXVPNnhWMERoMDlKY1R0d3lBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoieDQ3OHh5T3Bsc00xSDdOWGs3U3gxN3gxdXBjIiwia2lkIjoieDQ3OHh5T3Bsc00xSDdOWGs3U3gxN3gxdXBjIn0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hMDkzNzU0Ni1mNmQ0LTQwZTAtYWEzMi1mN2MzN2M4MDFhNGYvIiwiaWF0IjoxNTEzNDg2NTAxLCJuYmYiOjE1MTM0ODY1MDEsImV4cCI6MTUxMzQ5MDQwMSwiYWlvIjoiWTJOZ1lOakJ1VFZ4OTlNSmovUGVGNGpIUFdsV0J3QT0iLCJhcHBfZGlzcGxheW5hbWUiOiJMaWNlbnNlIFNoYXJlIiwiYXBwaWQiOiI1ZGU5OTU2My00ZWVjLTRjYzYtOTU5Yy04YWE0YTk3ZDBkNjkiLCJhcHBpZGFjciI6IjEiLCJpZHAiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hMDkzNzU0Ni1mNmQ0LTQwZTAtYWEzMi1mN2MzN2M4MDFhNGYvIiwidGlkIjoiYTA5Mzc1NDYtZjZkNC00MGUwLWFhMzItZjdjMzdjODAxYTRmIiwidXRpIjoialFQMS1VNlpFa0d1dEpsMDBNa1dBQSIsInZlciI6IjEuMCJ9.ho8cYxGaJcrhmNQE8eX8lr81VMRZ_OIbd0Es7aFTlleTHpldEfUHVhCTk63_jhJH_a8FmYlgHMNUHxUZCEauBXygNYmNTc-UYs4_UG6SAUEMiz28Qxa3wx32NKjen_dp5U-DMzKAkWxCnTcA5IdN0kikvUY39Zb82Y6mKTDUwfqJdiDRKsE3QhPFWX2ShUVCcBG7saBMPaQyr9953S53R4UXQjGHhS32iij4rDevUKdxXjAm5WG0McWjX6UGDQjprYYzTM41xXawu7UIO9YAnHj0NMyixQtR7ztklI9-84rIns1YQfjjsWQbDypsFHpuJAZEhdHy024OJxDi7gCWMg"
     }
  };

  var req3 = {
     method: "GET",
     url: "https://graph.microsoft.com/v1.0/users",
     headers: {
       'Authorization': "Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFCSGg0a21TX2FLVDVYcmp6eFJBdEh6SE9wZ1Nyb0pydzlBVUtfSkQ2UzZhSW9IZ0hIVHJmd1hqcXRYRFE2Y3dmbXJMZmJ0SUdLR0tzdDc4aGxhV1BzZUhpMlFmcVFaekJoenVUMFo2d1EyQ1NBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoieDQ3OHh5T3Bsc00xSDdOWGs3U3gxN3gxdXBjIiwia2lkIjoieDQ3OHh5T3Bsc00xSDdOWGs3U3gxN3gxdXBjIn0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hMDkzNzU0Ni1mNmQ0LTQwZTAtYWEzMi1mN2MzN2M4MDFhNGYvIiwiaWF0IjoxNTEzNDY4OTAyLCJuYmYiOjE1MTM0Njg5MDIsImV4cCI6MTUxMzQ3MjgwMiwiYWlvIjoiWTJOZ1lMalA1V1dtYmJiNjJHVFh2QlBDSmV0L0FRQT0iLCJhcHBfZGlzcGxheW5hbWUiOiJMaWNlbnNlIFNoYXJlIiwiYXBwaWQiOiI1ZGU5OTU2My00ZWVjLTRjYzYtOTU5Yy04YWE0YTk3ZDBkNjkiLCJhcHBpZGFjciI6IjEiLCJpZHAiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9hMDkzNzU0Ni1mNmQ0LTQwZTAtYWEzMi1mN2MzN2M4MDFhNGYvIiwidGlkIjoiYTA5Mzc1NDYtZjZkNC00MGUwLWFhMzItZjdjMzdjODAxYTRmIiwidXRpIjoiVlVGdmdNOUc5MDI4RnBQSXluZ1ZBQSIsInZlciI6IjEuMCJ9.KFdynZf6LslaMBmbSuMIHnm47qi3ka6WITV0vkU00uM5bXWqj7h5N-MmT3RAYjc7G2jzD-kK1cSRJ9E0olVPKMWG9WqCOilEU_IRBlvTfg__tBw15L8sbWnd6Lg-xSXmvxJEJBooWV2Pfnw42T0ZD7k1e5Jk-fGv9C7QZ9dno_XsTv2tJanUHm5SpofJLx5eme_Q0kIO8KeaYCWEaa1h8cdlAak4TW9a2BvS2iI7K4U_kPnOX8ixLr87qy75OWPxKT_gwWRDB_ugRUANMi-6nUDv_J921ZqAvZpeDmJRDkElRFIjrW9AoAP8sY1fQIrZ7FV1zA5sX3O_WmJxkm3_CQ"
     }
  };

  hp(req2)
  .then(function successCallback(response) {

    alert("Success!");
    //callGraphApi2(response);

  }, function errorCallback(response) {
    alert("Error!");
  });


}]);

    </script>
	
	</body>
</html>